@page
@model IndexModel
@{
    ViewData["Title"] = "Dashboard";
}

<!-- Header Section -->
<div class="mb-8 animate-fade-in">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
        <div>
            <h1 class="text-3xl font-bold text-neutral-900 mb-2">
                <i class="fas fa-tachometer-alt mr-3 text-primary-600"></i>Dashboard del Sistema
            </h1>
            <p class="text-neutral-600">Resumen general de la actividad del sistema</p>
        </div>
        <div class="mt-4 sm:mt-0">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800">
                <i class="fas fa-clock mr-2"></i>
                Último acceso: @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
            </span>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <!-- Users Card -->
    <div class="bg-white rounded-xl shadow-sm border border-neutral-200 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1 animate-slide-up">
        <div class="p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-neutral-600 mb-1">Total Usuarios</p>
                    <p class="text-3xl font-bold text-neutral-900">@Model.TotalUsers</p>
                    <p class="text-sm text-accent-green mt-1">
                        <i class="fas fa-arrow-up mr-1"></i>+5% este mes
                    </p>
                </div>
                <div class="bg-gradient-to-br from-primary-500 to-primary-600 p-4 rounded-xl">
                    <i class="fas fa-users text-white text-2xl"></i>
                </div>
            </div>
        </div>
        <div class="bg-neutral-50 px-6 py-3 border-t border-neutral-100 rounded-b-xl">
            <a href="/Users" class="text-primary-600 hover:text-primary-700 text-sm font-medium flex items-center transition-colors duration-200">
                Ver detalles
                <i class="fas fa-arrow-right ml-2 text-xs"></i>
            </a>
        </div>
    </div>

    <!-- Products Card -->
    <div class="bg-white rounded-xl shadow-sm border border-neutral-200 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1 animate-slide-up" style="animation-delay: 0.1s">
        <div class="p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-neutral-600 mb-1">Total Productos</p>
                    <p class="text-3xl font-bold text-neutral-900">@Model.TotalProducts</p>
                    <p class="text-sm text-accent-green mt-1">
                        <i class="fas fa-arrow-up mr-1"></i>+8% este mes
                    </p>
                </div>
                <div class="bg-gradient-to-br from-accent-green to-green-600 p-4 rounded-xl">
                    <i class="fas fa-box text-white text-2xl"></i>
                </div>
            </div>
        </div>
        <div class="bg-neutral-50 px-6 py-3 border-t border-neutral-100 rounded-b-xl">
            <a href="/Products" class="text-primary-600 hover:text-primary-700 text-sm font-medium flex items-center transition-colors duration-200">
                Ver detalles
                <i class="fas fa-arrow-right ml-2 text-xs"></i>
            </a>
        </div>
    </div>

    <!-- Orders Card -->
    <div class="bg-white rounded-xl shadow-sm border border-neutral-200 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1 animate-slide-up" style="animation-delay: 0.2s">
        <div class="p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-neutral-600 mb-1">Total Pedidos</p>
                    <p class="text-3xl font-bold text-neutral-900">@Model.TotalOrders</p>
                    <p class="text-sm text-primary-600 mt-1">
                        <i class="fas fa-chart-line mr-1"></i>+12% este mes
                    </p>
                </div>
                <div class="bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl">
                    <i class="fas fa-clipboard-list text-white text-2xl"></i>
                </div>
            </div>
        </div>
        <div class="bg-neutral-50 px-6 py-3 border-t border-neutral-100 rounded-b-xl">
            <a href="/Orders" class="text-primary-600 hover:text-primary-700 text-sm font-medium flex items-center transition-colors duration-200">
                Ver detalles
                <i class="fas fa-arrow-right ml-2 text-xs"></i>
            </a>
        </div>
    </div>

    <!-- Pending Orders Card (Enhanced) -->
    <div class="bg-white rounded-xl shadow-sm border border-neutral-200 hover:shadow-md transition-all duration-300 transform hover:-translate-y-1 animate-slide-up" style="animation-delay: 0.3s">
        <div class="p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-neutral-600 mb-1">Pedidos Pendientes</p>
                    <p class="text-3xl font-bold text-neutral-900">@Model.PendingOrders</p>
                    @if (Model.PendingOrders > 0)
                    {
                        <p class="text-sm text-accent-orange mt-1">
                            <i class="fas fa-exclamation-circle mr-1 animate-bounce-subtle"></i>Requiere atención
                        </p>
                    }
                    else
                    {
                        <p class="text-sm text-accent-green mt-1">
                            <i class="fas fa-check-circle mr-1"></i>Todo al día
                        </p>
                    }
                </div>
                <div class="bg-gradient-to-br from-accent-orange to-orange-600 p-4 rounded-xl @(Model.PendingOrders > 0 ? "animate-bounce-subtle" : "")">
                    <i class="fas fa-clock text-white text-2xl"></i>
                </div>
            </div>
        </div>
        <div class="bg-neutral-50 px-6 py-3 border-t border-neutral-100 rounded-b-xl">
            <a href="/Orders?status=Pendiente" class="text-primary-600 hover:text-primary-700 text-sm font-medium flex items-center transition-colors duration-200">
                @(Model.PendingOrders > 0 ? "Revisar ahora" : "Ver todos")
                <i class="fas fa-arrow-right ml-2 text-xs"></i>
            </a>
        </div>
    </div>
</div>

<!-- Main Content Grid -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Recent Orders (2/3 width) -->
    <div class="lg:col-span-2">
        <div class="bg-white rounded-xl shadow-sm border border-neutral-200">
            <div class="p-6 border-b border-neutral-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-neutral-900 flex items-center">
                        <i class="fas fa-list-alt mr-3 text-primary-600"></i>
                        Pedidos Recientes
                    </h3>
                    <a href="/Orders" class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105">
                        Ver todos
                    </a>
                </div>
                <p class="text-neutral-600 text-sm mt-1">Últimos 10 pedidos registrados en el sistema</p>
            </div>
            
            <div class="p-6">
                @if (Model.RecentOrders.Any())
                {
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="border-b border-neutral-200">
                                    <th class="text-left py-3 px-2 text-sm font-medium text-neutral-700">Número</th>
                                    <th class="text-left py-3 px-2 text-sm font-medium text-neutral-700">Cliente</th>
                                    <th class="text-left py-3 px-2 text-sm font-medium text-neutral-700">Fecha</th>
                                    <th class="text-left py-3 px-2 text-sm font-medium text-neutral-700">Estado</th>
                                    <th class="text-left py-3 px-2 text-sm font-medium text-neutral-700">Total</th>
                                    <th class="text-left py-3 px-2 text-sm font-medium text-neutral-700">Acciones</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-neutral-100">
                                @foreach (var order in Model.RecentOrders)
                                {
                                    <tr class="hover:bg-neutral-50 transition-colors duration-150">
                                        <td class="py-4 px-2">
                                            <div class="text-sm font-medium text-neutral-900">@order.OrderNumber</div>
                                        </td>
                                        <td class="py-4 px-2">
                                            <div class="flex items-center">
                                                <div class="bg-gradient-to-br from-primary-500 to-accent-purple p-2 rounded-full mr-3">
                                                    <i class="fas fa-user text-white text-xs"></i>
                                                </div>
                                                <div class="text-sm text-neutral-900">@order.User?.FullName</div>
                                            </div>
                                        </td>
                                        <td class="py-4 px-2">
                                            <div class="text-sm text-neutral-900">@order.OrderDate.ToString("dd/MM/yyyy")</div>
                                            <div class="text-xs text-neutral-500">@order.OrderDate.ToString("HH:mm")</div>
                                        </td>
                                        <td class="py-4 px-2">
                                            @switch (order.Status)
                                            {
                                                case OrderStatus.Pendiente:
                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                        <span class="w-1.5 h-1.5 bg-yellow-500 rounded-full mr-1.5"></span>
                                                        Pendiente
                                                    </span>
                                                    break;
                                                case OrderStatus.Procesado:
                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                        <span class="w-1.5 h-1.5 bg-blue-500 rounded-full mr-1.5"></span>
                                                        Procesado
                                                    </span>
                                                    break;
                                                case OrderStatus.Enviado:
                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                                                        <span class="w-1.5 h-1.5 bg-purple-500 rounded-full mr-1.5"></span>
                                                        Enviado
                                                    </span>
                                                    break;
                                                case OrderStatus.Entregado:
                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                        <span class="w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"></span>
                                                        Entregado
                                                    </span>
                                                    break;
                                                case OrderStatus.Cancelado:
                                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                                        <span class="w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"></span>
                                                        Cancelado
                                                    </span>
                                                    break;
                                            }
                                        </td>
                                        <td class="py-4 px-2">
                                            <div class="text-sm font-medium text-neutral-900">${@order.Total.ToString("N2")}</div>
                                        </td>
                                        <td class="py-4 px-2">
                                            <a href="/Orders/Details/@order.Id" 
                                               class="bg-neutral-100 hover:bg-neutral-200 text-neutral-700 hover:text-neutral-900 p-2 rounded-lg transition-all duration-200 transform hover:scale-105 inline-flex items-center"
                                               title="Ver detalles">
                                                <i class="fas fa-eye text-sm"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                }
                else
                {
                    <div class="text-center py-12">
                        <div class="bg-neutral-100 rounded-full p-6 w-24 h-24 mx-auto mb-4 flex items-center justify-center">
                            <i class="fas fa-inbox text-neutral-400 text-2xl"></i>
                        </div>
                        <h4 class="text-lg font-medium text-neutral-900 mb-2">No hay pedidos recientes</h4>
                        <p class="text-neutral-600 mb-4">Comienza creando tu primer pedido</p>
                        <a href="/Orders/Create" class="bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg text-sm font-medium transition-all duration-200 transform hover:scale-105">
                            <i class="fas fa-plus mr-2"></i>Crear primer pedido
                        </a>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Sidebar (1/3 width) -->
    <div class="space-y-6">
        <!-- Low Stock Alert -->
        <div class="bg-white rounded-xl shadow-sm border border-neutral-200">
            <div class="p-6 border-b border-neutral-200">
                <h3 class="text-lg font-semibold text-neutral-900 flex items-center">
                    <i class="fas fa-exclamation-triangle mr-3 text-accent-orange"></i>
                    Stock Bajo
                </h3>
                <p class="text-neutral-600 text-sm mt-1">Productos que necesitan reposición</p>
            </div>
            
            <div class="p-6">
                @if (Model.LowStockProducts.Any())
                {
                    <div class="space-y-4">
                        @foreach (var product in Model.LowStockProducts.Take(5))
                        {
                            <div class="flex items-center justify-between p-3 bg-red-50 border border-red-100 rounded-lg">
                                <div class="flex-1">
                                    <div class="text-sm font-medium text-neutral-900">@product.Name</div>
                                    <div class="text-xs text-neutral-600">@product.Category</div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs font-medium">
                                        @product.Stock
                                    </span>
                                    <button class="text-red-600 hover:text-red-700 transition-colors duration-200" title="Reponer stock">
                                        <i class="fas fa-plus-circle"></i>
                                    </button>
                                </div>
                            </div>
                        }
                        @if (Model.LowStockProducts.Count > 5)
                        {
                            <div class="text-center pt-2">
                                <a href="/Products?filter=lowstock" class="text-accent-orange hover:text-orange-700 text-sm font-medium">
                                    Y @(Model.LowStockProducts.Count - 5) productos más...
                                </a>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="text-center py-6">
                        <div class="bg-green-100 rounded-full p-4 w-16 h-16 mx-auto mb-3 flex items-center justify-center">
                            <i class="fas fa-check-circle text-accent-green text-xl"></i>
                        </div>
                        <p class="text-sm text-neutral-600">Todos los productos tienen stock suficiente</p>
                    </div>
                }
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-xl shadow-sm border border-neutral-200">
            <div class="p-6 border-b border-neutral-200">
                <h3 class="text-lg font-semibold text-neutral-900 flex items-center">
                    <i class="fas fa-bolt mr-3 text-accent-yellow"></i>
                    Acciones Rápidas
                </h3>
                <p class="text-neutral-600 text-sm mt-1">Operaciones frecuentes del sistema</p>
            </div>
            
            <div class="p-6">
                <div class="space-y-3">
                    <a href="/Orders/Create" 
                       class="w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center group">
                        <i class="fas fa-plus mr-3 group-hover:animate-bounce-subtle"></i>
                        <span>Crear Pedido</span>
                        <i class="fas fa-arrow-right ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200"></i>
                    </a>
                    
                    <a href="/Products/Create" 
                       class="w-full bg-accent-green hover:bg-green-600 text-white px-4 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center group">
                        <i class="fas fa-box mr-3 group-hover:animate-bounce-subtle"></i>
                        <span>Agregar Producto</span>
                        <i class="fas fa-arrow-right ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200"></i>
                    </a>
                    
                    <a href="/Users/Create" 
                       class="w-full bg-accent-purple hover:bg-purple-600 text-white px-4 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 flex items-center group">
                        <i class="fas fa-user-plus mr-3 group-hover:animate-bounce-subtle"></i>
                        <span>Registrar Usuario</span>
                        <i class="fas fa-arrow-right ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200"></i>
                    </a>
                    
                    <div class="border-t border-neutral-200 pt-3 mt-4">
                        <a href="/Reports" 
                           class="w-full bg-neutral-100 hover:bg-neutral-200 text-neutral-700 hover:text-neutral-900 px-4 py-3 rounded-lg font-medium transition-all duration-200 flex items-center group">
                            <i class="fas fa-chart-bar mr-3"></i>
                            <span>Ver Reportes</span>
                            <i class="fas fa-arrow-right ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Status -->
        <div class="bg-white rounded-xl shadow-sm border border-neutral-200">
            <div class="p-6 border-b border-neutral-200">
                <h3 class="text-lg font-semibold text-neutral-900 flex items-center">
                    <i class="fas fa-heartbeat mr-3 text-red-500"></i>
                    Estado del Sistema
                </h3>
            </div>
            
            <div class="p-6">
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-neutral-600">Base de Datos</span>
                        <span class="flex items-center text-accent-green text-sm">
                            <span class="w-2 h-2 bg-accent-green rounded-full mr-2"></span>
                            Conectado
                        </span>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-neutral-600">Servidor</span>
                        <span class="flex items-center text-accent-green text-sm">
                            <span class="w-2 h-2 bg-accent-green rounded-full mr-2"></span>
                            Operativo
                        </span>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-neutral-600">Última sincronización</span>
                        <span class="text-sm text-neutral-600">Hace 2 min</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Auto-refresh data every 5 minutes
        setInterval(function() {
            location.reload();
        }, 300000);
        
        // Add subtle animations to statistics cards
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.animate-slide-up');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
}